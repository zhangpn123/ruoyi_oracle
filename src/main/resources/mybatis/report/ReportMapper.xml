<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.project.report.report.mapper.ReportMapper">

    <select id="getData" parameterType="java.util.Map" resultType="com.ruoyi.project.report.report.domain.ReportRsp">
        select sum(gb.CR_AMT) as "caAmt", gb.B_ACC_CODE as "bAccCode",gb.ACC_CODE as "accCode" from GL_BAL gb
        <where>
            gb.B_ACC_CODE != '*'
            <if test="bAccCode != null and bAccCode != ''">
            <bind name="bAccCode" value="bAccCode + '%'"/>
                and B_ACC_CODE LIKE #{bAccCode}
            </if>
            <if test="deptName != null and deptName != ''">
                <bind name="deptName" value="deptName+'%'"/>
                and gb.co_code Like #{deptName}
            </if>
        </where>
        group by gb.B_ACC_CODE, gb.ACC_CODE
    </select>

    <select id="getDateByCondition" parameterType="java.util.Map" resultType="java.util.Map">
        select sum(gb.CR_AMT) as "caAmt", gb.B_ACC_CODE as "bAccCode" from GL_BAL gb
        <where>
            gb.B_ACC_CODE != '*'
            <if test="acc_code != null and acc_code != ''">
                <bind name="acc_code" value="acc_code+'%'"/>
                and ACC_CODE LIKE #{acc_code}
            </if>
            <if test="deptName != null and deptName != ''">
                <bind name="deptName" value="deptName+'%'"/>
                and co_code Like #{deptName}
            </if>
            <if test="acc_item1 != null and acc_item1 != ''">
                and acc_item1 LIKE  #{acc_item1}
            </if>
        </where>
        group by gb.B_ACC_CODE
    </select>

    <select id="getDataByAccCode" parameterType="java.util.Map" resultType="java.util.Map">
        select sum(gb.CR_AMT)  as crAmt from GL_BAL gb
        where 1=1
            <if test="acc_code != null and acc_code != ''">
                <bind name="acc_code" value="acc_code+'%'"/>
                and ACC_CODE LIKE #{acc_code}
            </if>
            <if test="deptName != null and deptName != ''">
                <bind name="deptName" value="deptName+'%'"/>
                and co_code Like #{deptName}
            </if>
    </select>

    <select id="getCRAmt" parameterType="java.util.Map" resultType="java.util.Map">
        select sum(gb.CR_AMT)  as crAmt from GL_BAL gb where 1=1
        <if test="acc_code != null and acc_code != ''">
            <bind name="acc_code" value="acc_code+'%'"/>
            and ACC_CODE LIKE #{acc_code}
        </if>
        <if test="deptName != null and deptName != ''">
            <bind name="deptName" value="deptName+'%'"/>
            and co_code Like #{deptName}
        </if>
        <if test="acc_item1 != null and acc_item1 != ''">
            and acc_item1 LIKE  #{acc_item1}
        </if>
    </select>

</mapper>